From 33ce0a534cfbaefdfbee98b4041e7019f2cae44e Mon Sep 17 00:00:00 2001
From: Caleb Xu <calebcenter@live.com>
Date: Sat, 25 Aug 2018 16:17:14 -0400
Subject: [PATCH 33/33] makefile: include Polly flags

Change-Id: I0425cfffc6f895b1dd84ed376396519b39433d0c
---
 Makefile | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/Makefile b/Makefile
index 41d4ea7b15c4..87571f1d8d69 100644
--- a/Makefile
+++ b/Makefile
@@ -401,7 +401,18 @@ ifneq ($(CLANG_ENABLE_IA),1)
 CLANG_IA_FLAG	= -no-integrated-as
 endif
 KBUILD_CPPFLAGS += $(CLANG_TARGET) $(CLANG_GCC_TC)
-CLANG_FLAGS	:= $(CLANG_TARGET) $(CLANG_GCC_TC) $(CLANG_IA_FLAG) -meabi gnu
+POLLY           := -O3 -mllvm -polly \
+		   -mllvm -polly-ast-use-context \
+		   -mllvm -polly-opt-fusion=max \
+		   -mllvm -polly-opt-maximize-bands=yes \
+		   -mllvm -polly-run-dce \
+		   -mllvm -polly-dependences-computeout=0 \
+		   -mllvm -polly-dependences-analysis-type=value-based \
+		   -mllvm -polly-position=after-loopopt \
+		   -mllvm -polly-run-inliner \
+		   -mllvm -polly-detect-keep-going \
+		   -mllvm -polly-rtc-max-arrays-per-group=40
+CLANG_FLAGS	:= $(CLANG_TARGET) $(CLANG_GCC_TC) $(CLANG_IA_FLAG) $(POLLY) -meabi gnu
 endif
 
 # Use USERINCLUDE when you must reference the UAPI directories only.
-- 
2.18.0

